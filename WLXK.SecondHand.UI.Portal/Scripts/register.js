var emailisuser; $(function () { $('#user_submit').click(function () { $("#Message").text('') }); $('#uid').css("background", "url(/Content/images/reg_uid.png) no-repeat right"); $("input.user_input").focus(function () { $(this).next(".user_msg").css("display", "block") }); $('#uid').blur(function () { CheckUid(); CheckUidIsExsiter() }); function CheckUidIsExsiter() { if ($("#uid").val().length >= 4 && CheckUid()) { $("#uidinfo").text("检测用户名是否可用..."); $("#uidinfo").css("display", "block"); $("#uidinfo").css("color", "green"); $.get("/account/CheckUid", { uid: $("#uid").val() }, function (data) { if (data == "1") { $("#uidinfo").css("display", "block"); $("#uidinfo").removeClass("user_msg"); $("#uidinfo").addClass("regmsg"); $("#uidinfo").css("color", "red"); $("#uidinfo").html("用户已存在,如果您是此帐号拥有者,请点击<a href='/account/login'>登录</a>"); $('#uid').css("background", "url(/Content/images/reg_uid.png) no-repeat right"); return false } else if (data == "0") { $("#uidinfo").text("恭喜您用户名可用"); $("#uidinfo").css("display", "block"); $("#uidinfo").css("color", "green"); return true } else { $("#uidinfo").css("display", "block"); $("#uidinfo").removeClass("user_msg"); $("#uidinfo").addClass("regmsg"); $("#uidinfo").text("服务器错误"); $('#uid').css("background", "url(/Content/images/reg_uid.png) no-repeat right"); return false } }) } } $("#pwd1").focus(function () { $("#tabpwd").css("display", "block"); setInterval(pwdget, 200) }); $("#pwd1").blur(function () { CheckPwd() }); $("#pwd2").focus(function () { setInterval(pwdIsTrue, 500) }); $("#pwd2").blur(function () { pwdIsTrue() }); $("#email").blur(function () { CheckEmail(); if (CheckEmail()) { CheckEmailExist() } }); function CheckEmailExist() { $.get("/account/CheckExistEmail", { email: $("#email").val() }, function (data) { if (data == "1") { emailisuser = data; $('#email').css("background", "url(/Content/images/reg_email.png) no-repeat right"); $("#emialmsg").removeClass("user_msg"); $("#emialmsg").addClass("regmsg"); $("#emialmsg").css("display", "block"); $("#emialmsg").html("邮箱已注册,如果忘记密码，请点击<a href='Account/Forget'>找回密码</a>"); return false } else { return true } }) } }); function CheckUid() { var uid = $("#uid").val(); var div = $("#uidinfo"); var reg = /^(.{4,20})$/; $('#uid').css("background", "url(/Content/images/reg_uid.png) no-repeat right"); $("#uidinfo").css("display", "none"); $("#uidinfo").css("color", "red"); if (!reg.test(uid)) { div.removeClass("user_msg"); div.addClass("regmsg"); if (uid.length < 4) { $("#uidinfo").css("display", "block"); div.text("用户名长度必须在4-20位字符之间"); return false } } reg1 = /^(\d+)$/; if (reg1.test(uid)) { $("#uidinfo").css("display", "block"); div.removeClass("user_msg"); div.addClass("regmsg"); div.text("用户名不允许只输入数字"); return false } $("#uidinfo").css("display", "none"); $('#uid').css("background", "url(/Content/images/success.png) no-repeat right"); return true } function CheckPwd() { var pwd1 = $("#pwd1"); var div = $("#pwd1msg"); if (pwd1.val().length <= 0) { div.removeClass("user_msg"); div.addClass("regmsg"); div.css("display", "block"); div.text("请输入密码"); return false } else if (pwd1.val().length < 6 && pwd1.val().length > 0) { div.removeClass("user_msg"); div.addClass("regmsg"); div.css("display", "block"); div.text("密码不能小于6位"); return false } else { div.css("display", "none"); $('#pwd1').css("background", "url(/Content/images/success.png) no-repeat right"); return true } } function pwdget() { $("#tabpwd td").css("backgroundColor", "#C4C4C4"); var len = CheckPwd1(); if ($("#pwd1").val().length > 0) { if (len <= 0) { } else if (len == 1) { $("#one").css("backgroundColor", "#F75733") } else if (len == 2) { $("#one").css("backgroundColor", "#F75733"); $("#two").css("backgroundColor", "#F75733") } else if (len == 3) { $("#one").css("backgroundColor", "#F75733"); $("#two").css("backgroundColor", "#F75733"); $("#three").css("backgroundColor", "#F75733") } else { alert('错误') } } } function pwdIsTrue() { $("#pwd2msg").css("display", "none"); if ($("#pwd1").val() == $('#pwd2').val() && $("#pwd1").val().length > 0) { $('#pwd2').css("background", "url(/Content/images/success.png) no-repeat right"); return true } else { $('#pwd2').css("background", "url(/Content/images/reg_pwd.png) no-repeat right"); $("#pwd2msg").removeClass("user_msg"); $("#pwd2msg").addClass("regmsg"); $("#pwd2msg").css("display", "block"); $("#pwd2msg").text("两次密码输入不一致"); return false } } function CheckPwd1() { var pwd1 = $("#pwd1").val(); var len = 0; if (/\d/.test(pwd1)) { len++ } if (/[a-zA-Z]/.test(pwd1)) { len++ } if (/[^a-zA-Z0-9]/.test(pwd1)) { len++ } if (pwd1.length < 6) { len-- } return len } function CheckEmail() { if (/^([-a-zA-Z0-9_.]+@[-a-zA-Z0-9_]+(\.[a-zA-Z0-9.]+)+)$/.test($("#email").val())) { $('#email').css("background", "url(/Content/images/success.png) no-repeat right"); $("#emialmsg").css("display", "none"); return true } else { $('#email').css("background", "url(/Content/images/reg_email.png) no-repeat right"); $("#emialmsg").removeClass("user_msg"); $("#emialmsg").addClass("regmsg"); $("#emialmsg").css("display", "block"); $("#emialmsg").text("请输入正确的邮箱"); return false } } function EmailTrue() { return true } function CheckFrom() { if (CheckUid() && CheckPwd() && pwdIsTrue() && CheckEmail() && CheckUidIsExsiter() && CheckEmailExist) { return true } else { return false } }